/* KEY POSITIONS (using keypos_def helpers)
╭─────────────────────┬─────────────────────╮
│ LT4 LT3 LT2 LT1 LT0 │ RT0 RT1 RT2 RT3 RT4 │
│ LM4 LM3 LM2 LM1 LM0 │ RM0 RM1 RM2 RM3 RM4 │
│ LB4 LB3 LB2 LB1 LB0 │ RB0 RB1 RB2 RB3 RB4 │
╰───────╮ LH2 LH1 LH0 │ RH0 RH1 RH2 ╭───────╯
        ╰─────────────┴─────────────╯       */

#define COMBO(NAME, BINDINGS, KEYPOS, LAYERS, TERM, QUICKTAP, ...) \
  combo_##NAME { \
    timeout-ms = <TERM>; \
    bindings = <BINDINGS>; \
    key-positions = <KEYPOS>; \
    layers = <LAYERS>; \
    require-prior-idle-ms = <QUICKTAP>; \
    __VA_ARGS__ \
  };

/ {
  combos {
    compatible = "zmk,combos";

    // function keys
    COMBO(tab,    &kp TAB,       RB1 RB2,     COL QWE SYM,  40, 100)
    COMBO(bspc,   &kp BSPC,      RM1 RM2,     COL QWE SYM,  40, 100)
    COMBO(ret,    &kp RET,       LM3 LM2 LM1, COL QWE SYM,  40,   0)

    // symbols
    COMBO(semi,   &kp SEMI,      RB2 RB3,     COL QWE SYM,  40, 100)
    COMBO(bslh,   &kp BSLH,      LM3 LM2 LM1, SYM,          60, 100)
    COMBO(pipe,   &kp PIPE,      LB3 LB2 LB1, SYM,          60, 100)

    COMBO(lbkt,   &kp LBKT,      LT3 LT2,     COL QWE SYM,  40, 100)
    COMBO(rbkt,   &kp RBKT,      LT2 LT1,     COL QWE SYM,  40, 100)
    COMBO(lpar,   &kp LPAR,      LM3 LM2,     COL QWE SYM,  40, 100)
    COMBO(rpar,   &kp RPAR,      LM2 LM1,     COL QWE SYM,  40, 100)
    COMBO(lbrc,   &kp LBRC,      LB3 LB2,     COL QWE SYM,  40, 100)
    COMBO(rbrc,   &kp RBRC,      LB2 LB1,     COL QWE SYM,  40, 100)

    // layers
    COMBO(mouse,  &tog MSE,      LB3 LB2 LB1, COL QWE MSE, 100, 100)

    // combinations
    COMBO(capswd, &caps_word,    LM1 RM1,     COL QWE,      60, 200)
    COMBO(caps,   &kp CAPS,      LM0 RM0,     COL QWE,      60, 200)
    COMBO(lock,   &kp LG(L),     RT1 RM4,     COL QWE,      80, 500)
    COMBO(undo,   &kp LC(Z),     LB3 LB2,     NAV,          80,  50)

    // media
    COMBO(play,   &kp C_PP,      RB1 RB2,     NAV,         200, 200)

    // misc
    // COMBO(bootld, &bootloader,   LT0 RT0,     FUN,         100, 500)
  };
};
